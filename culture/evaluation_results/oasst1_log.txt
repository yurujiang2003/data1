INFO 03-06 14:23:13 __init__.py:190] Automatically detected platform cuda.
INFO 03-06 14:23:14 config.py:2382] Downcasting torch.float32 to torch.bfloat16.
INFO 03-06 14:23:24 config.py:542] This model supports multiple tasks: {'embed', 'score', 'reward', 'generate', 'classify'}. Defaulting to 'generate'.
INFO 03-06 14:23:24 llm_engine.py:234] Initializing a V0 LLM engine (v0.7.2) with config: model='sparta_alignment/base_model', speculative_config=None, tokenizer='sparta_alignment/base_model', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=sparta_alignment/base_model, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False, 
INFO 03-06 14:23:28 cuda.py:230] Using Flash Attention backend.
INFO 03-06 14:23:32 model_runner.py:1110] Starting to load model sparta_alignment/base_model...
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:01<00:08,  1.19s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:02<00:06,  1.07s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:03<00:06,  1.21s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:03<00:03,  1.21it/s]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:04<00:02,  1.20it/s]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:05<00:01,  1.06it/s]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:07<00:01,  1.03s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:08<00:00,  1.12s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:08<00:00,  1.04s/it]

INFO 03-06 14:23:41 model_runner.py:1115] Loading model weights took 15.9066 GB
INFO 03-06 14:23:41 punica_selector.py:18] Using PunicaWrapperGPU.
INFO 03-06 14:23:48 worker.py:267] Memory profiling takes 5.82 seconds
INFO 03-06 14:23:48 worker.py:267] the current vLLM instance can use total_gpu_memory (39.38GiB) x gpu_memory_utilization (0.80) = 31.50GiB
INFO 03-06 14:23:48 worker.py:267] model weights take 15.91GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 2.37GiB; the rest of the memory reserved for KV Cache is 13.13GiB.
INFO 03-06 14:23:48 executor_base.py:110] # CUDA blocks: 1921, # CPU blocks: 585
INFO 03-06 14:23:48 executor_base.py:115] Maximum concurrency for 8192 tokens per request: 3.75x
INFO 03-06 14:23:52 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:01<00:48,  1.44s/it]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:02<00:37,  1.15s/it]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:03<00:33,  1.05s/it]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:04<00:30,  1.00it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:05<00:28,  1.05it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:06<00:27,  1.06it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:06<00:25,  1.09it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:07<00:24,  1.10it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:08<00:23,  1.13it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:09<00:22,  1.13it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:10<00:20,  1.16it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:11<00:19,  1.17it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:11<00:18,  1.18it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:12<00:17,  1.19it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:13<00:16,  1.22it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:14<00:15,  1.20it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:15<00:14,  1.22it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:16<00:13,  1.23it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:16<00:13,  1.23it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:17<00:12,  1.23it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:18<00:11,  1.22it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:19<00:10,  1.23it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:20<00:09,  1.22it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:20<00:08,  1.23it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:21<00:08,  1.25it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:22<00:07,  1.25it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:23<00:06,  1.24it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:24<00:05,  1.25it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:24<00:04,  1.25it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:25<00:03,  1.26it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:26<00:03,  1.24it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:27<00:02,  1.24it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:28<00:01,  1.24it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:28<00:00,  1.22it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:29<00:00,  1.14it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:29<00:00,  1.17it/s]
INFO 03-06 14:24:22 model_runner.py:1562] Graph capturing finished in 30 secs, took 0.37 GiB
INFO 03-06 14:24:22 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 40.54 seconds

================================================================================
Dataset                        Accuracy   Correct    Total     
--------------------------------------------------------------------------------
Processing sparta_alignment/data/culture/country_dataset.json...
Processed prompts:   0%|          | 0/263 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]WARNING 03-06 14:24:27 scheduler.py:1560] Sequence group 94 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=1
Processed prompts:   0%|          | 1/263 [00:03<14:30,  3.32s/it, est. speed input: 68.64 toks/s, output: 2.71 toks/s]Processed prompts:   1%|          | 2/263 [00:09<22:37,  5.20s/it, est. speed input: 81.19 toks/s, output: 12.40 toks/s]Processed prompts:   1%|          | 3/263 [00:10<14:20,  3.31s/it, est. speed input: 94.96 toks/s, output: 23.12 toks/s]Processed prompts:   2%|▏         | 4/263 [00:11<09:54,  2.29s/it, est. speed input: 131.94 toks/s, output: 33.95 toks/s]Processed prompts:   2%|▏         | 5/263 [00:13<08:58,  2.09s/it, est. speed input: 135.00 toks/s, output: 42.53 toks/s]Processed prompts:   3%|▎         | 7/263 [00:15<06:39,  1.56s/it, est. speed input: 155.88 toks/s, output: 61.60 toks/s]Processed prompts:   3%|▎         | 8/263 [00:15<05:13,  1.23s/it, est. speed input: 178.37 toks/s, output: 74.15 toks/s]Processed prompts:   3%|▎         | 9/263 [00:16<05:02,  1.19s/it, est. speed input: 174.18 toks/s, output: 83.38 toks/s]Processed prompts:   4%|▍         | 10/263 [00:18<05:38,  1.34s/it, est. speed input: 167.92 toks/s, output: 90.31 toks/s]Processed prompts:   4%|▍         | 11/263 [00:19<05:07,  1.22s/it, est. speed input: 177.98 toks/s, output: 100.86 toks/s]Processed prompts:   5%|▍         | 12/263 [00:20<04:50,  1.16s/it, est. speed input: 186.02 toks/s, output: 111.01 toks/s]Processed prompts:   5%|▌         | 14/263 [00:20<02:49,  1.47it/s, est. speed input: 200.97 toks/s, output: 139.83 toks/s]Processed prompts:   6%|▌         | 15/263 [00:21<02:29,  1.66it/s, est. speed input: 207.05 toks/s, output: 152.51 toks/s]Processed prompts:   6%|▌         | 16/263 [00:21<02:05,  1.96it/s, est. speed input: 226.49 toks/s, output: 165.95 toks/s]Processed prompts:   6%|▋         | 17/263 [00:21<01:55,  2.14it/s, est. speed input: 241.35 toks/s, output: 178.40 toks/s]Processed prompts:   7%|▋         | 19/263 [00:22<01:53,  2.15it/s, est. speed input: 259.47 toks/s, output: 198.15 toks/s]Processed prompts:   8%|▊         | 20/263 [00:22<01:36,  2.51it/s, est. speed input: 272.21 toks/s, output: 211.92 toks/s]Processed prompts:   8%|▊         | 21/263 [00:22<01:19,  3.05it/s, est. speed input: 282.49 toks/s, output: 226.19 toks/s]Processed prompts:   8%|▊         | 22/263 [00:23<01:17,  3.10it/s, est. speed input: 288.25 toks/s, output: 238.54 toks/s]Processed prompts:   9%|▊         | 23/263 [00:23<01:22,  2.91it/s, est. speed input: 293.70 toks/s, output: 249.88 toks/s]Processed prompts:   9%|▉         | 24/263 [00:24<01:51,  2.15it/s, est. speed input: 318.49 toks/s, output: 257.44 toks/s]Processed prompts:  10%|▉         | 25/263 [00:25<02:02,  1.94it/s, est. speed input: 321.45 toks/s, output: 266.43 toks/s]Processed prompts:  10%|▉         | 26/263 [00:25<02:13,  1.77it/s, est. speed input: 321.39 toks/s, output: 275.03 toks/s]Processed prompts:  10%|█         | 27/263 [00:26<02:30,  1.57it/s, est. speed input: 325.34 toks/s, output: 282.36 toks/s]Processed prompts:  11%|█         | 29/263 [00:27<02:36,  1.49it/s, est. speed input: 326.01 toks/s, output: 293.55 toks/s]Processed prompts:  11%|█▏        | 30/263 [00:29<03:12,  1.21it/s, est. speed input: 323.89 toks/s, output: 296.68 toks/s]WARNING 03-06 14:24:54 scheduler.py:1560] Sequence group 66 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=51
Processed prompts:  12%|█▏        | 31/263 [00:30<03:12,  1.21it/s, est. speed input: 320.83 toks/s, output: 297.83 toks/s]Processed prompts:  12%|█▏        | 32/263 [00:31<03:19,  1.16it/s, est. speed input: 317.06 toks/s, output: 305.11 toks/s]Processed prompts:  24%|██▍       | 63/263 [00:33<00:26,  7.44it/s, est. speed input: 593.28 toks/s, output: 746.23 toks/s]Processed prompts:  24%|██▍       | 64/263 [00:34<00:33,  5.95it/s, est. speed input: 585.50 toks/s, output: 740.38 toks/s]Processed prompts:  25%|██▍       | 65/263 [00:34<00:39,  5.05it/s, est. speed input: 584.87 toks/s, output: 726.62 toks/s]Processed prompts:  25%|██▌       | 66/263 [00:36<00:55,  3.55it/s, est. speed input: 572.68 toks/s, output: 713.78 toks/s]Processed prompts:  25%|██▌       | 67/263 [00:38<01:22,  2.37it/s, est. speed input: 553.32 toks/s, output: 683.98 toks/s]Processed prompts:  26%|██▌       | 68/263 [00:38<01:25,  2.28it/s, est. speed input: 554.07 toks/s, output: 687.37 toks/s]Processed prompts:  26%|██▌       | 69/263 [00:39<01:40,  1.92it/s, est. speed input: 549.29 toks/s, output: 672.48 toks/s]Processed prompts:  27%|██▋       | 70/263 [00:39<01:28,  2.17it/s, est. speed input: 559.25 toks/s, output: 672.17 toks/s]Processed prompts:  27%|██▋       | 71/263 [00:41<02:30,  1.28it/s, est. speed input: 535.01 toks/s, output: 641.97 toks/s]Processed prompts:  28%|██▊       | 73/263 [00:42<01:59,  1.59it/s, est. speed input: 543.97 toks/s, output: 648.70 toks/s]Processed prompts:  28%|██▊       | 74/263 [00:43<02:06,  1.49it/s, est. speed input: 539.71 toks/s, output: 639.95 toks/s]Processed prompts:  29%|██▉       | 76/263 [00:44<01:54,  1.64it/s, est. speed input: 541.38 toks/s, output: 640.88 toks/s]Processed prompts:  29%|██▉       | 77/263 [00:44<01:34,  1.98it/s, est. speed input: 545.60 toks/s, output: 650.86 toks/s]Processed prompts:  30%|██▉       | 78/263 [00:45<01:49,  1.69it/s, est. speed input: 541.60 toks/s, output: 644.83 toks/s]Processed prompts:  30%|███       | 79/263 [00:45<01:44,  1.76it/s, est. speed input: 541.79 toks/s, output: 642.40 toks/s]Processed prompts:  30%|███       | 80/263 [00:47<02:24,  1.27it/s, est. speed input: 530.39 toks/s, output: 630.75 toks/s]Processed prompts:  31%|███       | 82/263 [00:47<01:30,  1.99it/s, est. speed input: 538.59 toks/s, output: 638.72 toks/s]Processed prompts:  32%|███▏      | 83/263 [00:47<01:16,  2.35it/s, est. speed input: 539.96 toks/s, output: 647.13 toks/s]Processed prompts:  32%|███▏      | 84/263 [00:48<01:07,  2.66it/s, est. speed input: 542.39 toks/s, output: 646.35 toks/s]Processed prompts:  33%|███▎      | 86/263 [00:48<01:07,  2.64it/s, est. speed input: 550.09 toks/s, output: 650.39 toks/s]Processed prompts:  33%|███▎      | 87/263 [00:49<01:27,  2.01it/s, est. speed input: 545.09 toks/s, output: 644.11 toks/s]Processed prompts:  34%|███▍      | 89/263 [00:51<01:58,  1.47it/s, est. speed input: 534.07 toks/s, output: 635.27 toks/s]Processed prompts:  34%|███▍      | 90/263 [00:51<01:45,  1.64it/s, est. speed input: 534.71 toks/s, output: 636.78 toks/s]Processed prompts:  35%|███▍      | 91/263 [00:52<01:56,  1.47it/s, est. speed input: 530.91 toks/s, output: 634.90 toks/s]Processed prompts:  35%|███▍      | 92/263 [00:53<01:38,  1.74it/s, est. speed input: 529.89 toks/s, output: 637.97 toks/s]Processed prompts:  35%|███▌      | 93/263 [00:53<01:27,  1.93it/s, est. speed input: 529.00 toks/s, output: 639.97 toks/s]Processed prompts:  36%|███▌      | 94/263 [00:53<01:21,  2.08it/s, est. speed input: 529.59 toks/s, output: 641.88 toks/s]Processed prompts:  37%|███▋      | 96/263 [00:54<00:53,  3.11it/s, est. speed input: 532.09 toks/s, output: 651.86 toks/s]Processed prompts:  37%|███▋      | 97/263 [00:55<01:40,  1.65it/s, est. speed input: 526.18 toks/s, output: 641.04 toks/s]Processed prompts:  37%|███▋      | 98/263 [00:56<02:10,  1.26it/s, est. speed input: 515.91 toks/s, output: 634.11 toks/s]Processed prompts:  38%|███▊      | 99/263 [00:57<01:55,  1.42it/s, est. speed input: 519.26 toks/s, output: 637.98 toks/s]Processed prompts:  38%|███▊      | 100/263 [00:58<01:56,  1.40it/s, est. speed input: 517.94 toks/s, output: 637.33 toks/s]Processed prompts:  38%|███▊      | 101/263 [00:58<01:34,  1.71it/s, est. speed input: 520.54 toks/s, output: 643.27 toks/s]WARNING 03-06 14:25:23 scheduler.py:1560] Sequence group 143 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=101
Processed prompts:  39%|███▉      | 102/263 [00:58<01:29,  1.79it/s, est. speed input: 525.21 toks/s, output: 646.57 toks/s]Processed prompts:  39%|███▉      | 103/263 [00:59<01:19,  2.02it/s, est. speed input: 526.58 toks/s, output: 650.38 toks/s]Processed prompts:  40%|███▉      | 104/263 [00:59<01:09,  2.30it/s, est. speed input: 529.96 toks/s, output: 654.81 toks/s]Processed prompts:  40%|███▉      | 105/263 [00:59<00:56,  2.81it/s, est. speed input: 533.27 toks/s, output: 661.56 toks/s]Processed prompts:  40%|████      | 106/263 [00:59<00:50,  3.14it/s, est. speed input: 533.60 toks/s, output: 667.57 toks/s]Processed prompts:  41%|████      | 107/263 [01:00<00:44,  3.48it/s, est. speed input: 535.58 toks/s, output: 673.69 toks/s]Processed prompts:  41%|████      | 108/263 [01:00<01:06,  2.33it/s, est. speed input: 531.88 toks/s, output: 673.70 toks/s]Processed prompts:  41%|████▏     | 109/263 [01:01<01:00,  2.53it/s, est. speed input: 533.20 toks/s, output: 678.56 toks/s]Processed prompts:  42%|████▏     | 110/263 [01:01<01:03,  2.39it/s, est. speed input: 536.87 toks/s, output: 681.18 toks/s]Processed prompts:  43%|████▎     | 112/263 [01:02<00:55,  2.73it/s, est. speed input: 550.45 toks/s, output: 690.94 toks/s]Processed prompts:  43%|████▎     | 113/263 [01:02<00:55,  2.68it/s, est. speed input: 550.54 toks/s, output: 694.47 toks/s]Processed prompts:  43%|████▎     | 114/263 [01:02<00:49,  2.98it/s, est. speed input: 554.96 toks/s, output: 700.09 toks/s]Processed prompts:  44%|████▎     | 115/263 [01:03<00:54,  2.69it/s, est. speed input: 555.25 toks/s, output: 703.01 toks/s]Processed prompts:  44%|████▍     | 117/263 [01:03<00:40,  3.59it/s, est. speed input: 557.80 toks/s, output: 715.57 toks/s]Processed prompts:  45%|████▍     | 118/263 [01:04<00:40,  3.56it/s, est. speed input: 560.02 toks/s, output: 720.35 toks/s]Processed prompts:  52%|█████▏    | 136/263 [01:06<00:19,  6.41it/s, est. speed input: 619.41 toks/s, output: 831.69 toks/s]Processed prompts:  52%|█████▏    | 137/263 [01:07<00:29,  4.27it/s, est. speed input: 616.24 toks/s, output: 822.38 toks/s]Processed prompts:  52%|█████▏    | 138/263 [01:08<00:38,  3.26it/s, est. speed input: 608.27 toks/s, output: 809.95 toks/s]Processed prompts:  53%|█████▎    | 139/263 [01:09<00:38,  3.18it/s, est. speed input: 608.43 toks/s, output: 807.18 toks/s]Processed prompts:  53%|█████▎    | 140/263 [01:09<00:40,  3.03it/s, est. speed input: 609.45 toks/s, output: 803.12 toks/s]Processed prompts:  54%|█████▎    | 141/263 [01:11<01:11,  1.71it/s, est. speed input: 594.81 toks/s, output: 783.00 toks/s]Processed prompts:  54%|█████▍    | 142/263 [01:12<01:06,  1.81it/s, est. speed input: 593.75 toks/s, output: 780.04 toks/s]Processed prompts:  54%|█████▍    | 143/263 [01:12<01:08,  1.75it/s, est. speed input: 591.05 toks/s, output: 780.26 toks/s]Processed prompts:  55%|█████▍    | 144/263 [01:14<01:51,  1.07it/s, est. speed input: 579.43 toks/s, output: 761.32 toks/s]Processed prompts:  55%|█████▌    | 145/263 [01:15<01:39,  1.19it/s, est. speed input: 577.34 toks/s, output: 758.56 toks/s]Processed prompts:  56%|█████▌    | 146/263 [01:15<01:27,  1.34it/s, est. speed input: 576.27 toks/s, output: 760.46 toks/s]Processed prompts:  56%|█████▌    | 147/263 [01:16<01:32,  1.25it/s, est. speed input: 576.92 toks/s, output: 753.81 toks/s]Processed prompts:  56%|█████▋    | 148/263 [01:17<01:40,  1.14it/s, est. speed input: 577.27 toks/s, output: 747.31 toks/s]Processed prompts:  57%|█████▋    | 149/263 [01:19<02:09,  1.14s/it, est. speed input: 569.35 toks/s, output: 733.81 toks/s]Processed prompts:  57%|█████▋    | 150/263 [01:20<01:49,  1.03it/s, est. speed input: 567.87 toks/s, output: 731.82 toks/s]Processed prompts:  57%|█████▋    | 151/263 [01:20<01:28,  1.27it/s, est. speed input: 570.22 toks/s, output: 734.95 toks/s]Processed prompts:  58%|█████▊    | 152/263 [01:21<01:45,  1.05it/s, est. speed input: 562.70 toks/s, output: 726.45 toks/s]Processed prompts:  59%|█████▊    | 154/263 [01:22<01:10,  1.54it/s, est. speed input: 562.67 toks/s, output: 731.66 toks/s]Processed prompts:  59%|█████▉    | 155/263 [01:23<01:07,  1.60it/s, est. speed input: 561.36 toks/s, output: 730.54 toks/s]Processed prompts:  59%|█████▉    | 156/263 [01:23<00:56,  1.90it/s, est. speed input: 563.37 toks/s, output: 732.12 toks/s]Processed prompts:  60%|█████▉    | 157/263 [01:24<01:27,  1.21it/s, est. speed input: 556.11 toks/s, output: 722.44 toks/s]Processed prompts:  60%|██████    | 159/263 [01:25<00:55,  1.87it/s, est. speed input: 559.11 toks/s, output: 729.98 toks/s]Processed prompts:  61%|██████    | 160/263 [01:25<00:45,  2.27it/s, est. speed input: 564.30 toks/s, output: 732.84 toks/s]Processed prompts:  61%|██████    | 161/263 [01:26<00:56,  1.82it/s, est. speed input: 560.95 toks/s, output: 731.39 toks/s]Processed prompts:  62%|██████▏   | 162/263 [01:27<01:03,  1.60it/s, est. speed input: 557.97 toks/s, output: 729.39 toks/s]Processed prompts:  62%|██████▏   | 163/263 [01:27<01:01,  1.62it/s, est. speed input: 556.45 toks/s, output: 728.94 toks/s]Processed prompts:  62%|██████▏   | 164/263 [01:28<01:09,  1.43it/s, est. speed input: 553.73 toks/s, output: 726.40 toks/s]Processed prompts:  63%|██████▎   | 165/263 [01:29<01:09,  1.42it/s, est. speed input: 551.62 toks/s, output: 725.28 toks/s]Processed prompts:  63%|██████▎   | 166/263 [01:29<00:54,  1.78it/s, est. speed input: 554.03 toks/s, output: 729.30 toks/s]Processed prompts:  63%|██████▎   | 167/263 [01:30<00:53,  1.80it/s, est. speed input: 552.66 toks/s, output: 729.95 toks/s]Processed prompts:  64%|██████▍   | 168/263 [01:30<00:49,  1.92it/s, est. speed input: 552.20 toks/s, output: 731.92 toks/s]Processed prompts:  64%|██████▍   | 169/263 [01:30<00:40,  2.33it/s, est. speed input: 556.51 toks/s, output: 735.86 toks/s]Processed prompts:  65%|██████▍   | 170/263 [01:31<00:35,  2.60it/s, est. speed input: 557.55 toks/s, output: 738.59 toks/s]Processed prompts:  65%|██████▌   | 171/263 [01:31<00:30,  3.00it/s, est. speed input: 559.23 toks/s, output: 742.46 toks/s]Processed prompts:  66%|██████▌   | 174/263 [01:31<00:18,  4.83it/s, est. speed input: 563.28 toks/s, output: 756.59 toks/s]Processed prompts:  67%|██████▋   | 175/263 [01:31<00:18,  4.77it/s, est. speed input: 565.19 toks/s, output: 760.37 toks/s]Processed prompts:  67%|██████▋   | 176/263 [01:32<00:21,  4.01it/s, est. speed input: 567.17 toks/s, output: 762.78 toks/s]Processed prompts:  67%|██████▋   | 177/263 [01:32<00:23,  3.70it/s, est. speed input: 566.42 toks/s, output: 765.55 toks/s]Processed prompts:  68%|██████▊   | 178/263 [01:32<00:27,  3.12it/s, est. speed input: 569.48 toks/s, output: 767.26 toks/s]Processed prompts:  69%|██████▉   | 182/263 [01:33<00:18,  4.28it/s, est. speed input: 573.11 toks/s, output: 783.38 toks/s]Processed prompts:  70%|██████▉   | 183/263 [01:34<00:23,  3.47it/s, est. speed input: 574.25 toks/s, output: 784.27 toks/s]Processed prompts:  70%|███████   | 185/263 [01:34<00:19,  4.09it/s, est. speed input: 577.07 toks/s, output: 790.52 toks/s]Processed prompts:  71%|███████   | 186/263 [01:34<00:18,  4.13it/s, est. speed input: 578.77 toks/s, output: 794.00 toks/s]Processed prompts:  71%|███████   | 187/263 [01:35<00:18,  4.12it/s, est. speed input: 581.08 toks/s, output: 797.34 toks/s]Processed prompts:  72%|███████▏  | 189/263 [01:35<00:16,  4.53it/s, est. speed input: 584.17 toks/s, output: 804.98 toks/s]Processed prompts:  78%|███████▊  | 205/263 [01:36<00:05, 10.32it/s, est. speed input: 623.35 toks/s, output: 880.73 toks/s]Processed prompts:  78%|███████▊  | 206/263 [01:37<00:07,  7.42it/s, est. speed input: 622.06 toks/s, output: 877.42 toks/s]Processed prompts:  79%|███████▊  | 207/263 [01:38<00:15,  3.72it/s, est. speed input: 612.74 toks/s, output: 865.60 toks/s]Processed prompts:  79%|███████▉  | 208/263 [01:40<00:22,  2.39it/s, est. speed input: 607.21 toks/s, output: 856.89 toks/s]Processed prompts:  79%|███████▉  | 209/263 [01:41<00:26,  2.04it/s, est. speed input: 602.90 toks/s, output: 852.08 toks/s]Processed prompts:  80%|███████▉  | 210/263 [01:42<00:30,  1.72it/s, est. speed input: 599.43 toks/s, output: 844.64 toks/s]Processed prompts:  80%|████████  | 211/263 [01:42<00:25,  2.00it/s, est. speed input: 601.44 toks/s, output: 845.57 toks/s]Processed prompts:  81%|████████▏ | 214/263 [01:42<00:16,  2.94it/s, est. speed input: 607.84 toks/s, output: 850.01 toks/s]Processed prompts:  82%|████████▏ | 215/263 [01:43<00:17,  2.68it/s, est. speed input: 607.30 toks/s, output: 847.68 toks/s]Processed prompts:  82%|████████▏ | 216/263 [01:43<00:16,  2.82it/s, est. speed input: 606.96 toks/s, output: 848.85 toks/s]Processed prompts:  83%|████████▎ | 218/263 [01:44<00:18,  2.39it/s, est. speed input: 606.07 toks/s, output: 843.66 toks/s]Processed prompts:  83%|████████▎ | 219/263 [01:45<00:18,  2.44it/s, est. speed input: 607.18 toks/s, output: 843.39 toks/s]Processed prompts:  84%|████████▎ | 220/263 [01:46<00:25,  1.70it/s, est. speed input: 604.25 toks/s, output: 836.02 toks/s]Processed prompts:  84%|████████▍ | 221/263 [01:47<00:25,  1.63it/s, est. speed input: 602.65 toks/s, output: 833.86 toks/s]Processed prompts:  84%|████████▍ | 222/263 [01:47<00:20,  2.05it/s, est. speed input: 604.81 toks/s, output: 834.97 toks/s]Processed prompts:  85%|████████▍ | 223/263 [01:47<00:16,  2.40it/s, est. speed input: 609.80 toks/s, output: 835.77 toks/s]Processed prompts:  85%|████████▌ | 224/263 [01:48<00:27,  1.43it/s, est. speed input: 605.18 toks/s, output: 827.38 toks/s]Processed prompts:  86%|████████▌ | 225/263 [01:49<00:26,  1.43it/s, est. speed input: 603.83 toks/s, output: 825.94 toks/s]Processed prompts:  86%|████████▌ | 226/263 [01:50<00:24,  1.52it/s, est. speed input: 603.19 toks/s, output: 825.76 toks/s]Processed prompts:  86%|████████▋ | 227/263 [01:50<00:20,  1.73it/s, est. speed input: 603.91 toks/s, output: 825.99 toks/s]Processed prompts:  87%|████████▋ | 228/263 [01:50<00:16,  2.08it/s, est. speed input: 608.12 toks/s, output: 826.95 toks/s]Processed prompts:  87%|████████▋ | 229/263 [01:50<00:13,  2.50it/s, est. speed input: 609.18 toks/s, output: 830.02 toks/s]Processed prompts:  87%|████████▋ | 230/263 [01:51<00:13,  2.41it/s, est. speed input: 609.98 toks/s, output: 831.28 toks/s]Processed prompts:  88%|████████▊ | 231/263 [01:52<00:15,  2.05it/s, est. speed input: 609.30 toks/s, output: 829.48 toks/s]Processed prompts:  88%|████████▊ | 232/263 [01:52<00:14,  2.18it/s, est. speed input: 612.33 toks/s, output: 831.13 toks/s]Processed prompts:  89%|████████▊ | 233/263 [01:52<00:12,  2.48it/s, est. speed input: 613.28 toks/s, output: 833.68 toks/s]Processed prompts:  89%|████████▉ | 234/263 [01:52<00:09,  3.05it/s, est. speed input: 613.59 toks/s, output: 836.10 toks/s]Processed prompts:  89%|████████▉ | 235/263 [01:53<00:08,  3.37it/s, est. speed input: 613.78 toks/s, output: 838.96 toks/s]Processed prompts:  90%|████████▉ | 236/263 [01:53<00:06,  4.14it/s, est. speed input: 615.38 toks/s, output: 842.66 toks/s]Processed prompts:  90%|█████████ | 237/263 [01:53<00:07,  3.33it/s, est. speed input: 614.69 toks/s, output: 842.96 toks/s]Processed prompts:  91%|█████████ | 239/263 [01:54<00:06,  3.52it/s, est. speed input: 616.05 toks/s, output: 847.12 toks/s]Processed prompts:  91%|█████████▏| 240/263 [01:55<00:11,  2.09it/s, est. speed input: 613.97 toks/s, output: 843.69 toks/s]Processed prompts:  92%|█████████▏| 241/263 [01:55<00:11,  1.98it/s, est. speed input: 613.78 toks/s, output: 843.88 toks/s]Processed prompts:  92%|█████████▏| 242/263 [01:56<00:10,  1.98it/s, est. speed input: 612.38 toks/s, output: 844.51 toks/s]Processed prompts:  92%|█████████▏| 243/263 [01:56<00:09,  2.06it/s, est. speed input: 612.45 toks/s, output: 845.77 toks/s]Processed prompts:  94%|█████████▍| 248/263 [01:57<00:02,  5.05it/s, est. speed input: 622.04 toks/s, output: 865.68 toks/s]Processed prompts:  95%|█████████▍| 249/263 [01:57<00:03,  4.40it/s, est. speed input: 623.60 toks/s, output: 867.21 toks/s]Processed prompts:  96%|█████████▌| 252/263 [01:57<00:01,  6.33it/s, est. speed input: 629.37 toks/s, output: 879.02 toks/s]Processed prompts:  97%|█████████▋| 255/263 [01:57<00:00,  8.89it/s, est. speed input: 639.49 toks/s, output: 891.30 toks/s]Processed prompts: 100%|██████████| 263/263 [01:57<00:00,  2.23it/s, est. speed input: 667.57 toks/s, output: 926.08 toks/s]
country_dataset                0.3498    92         263       
Processing sparta_alignment/data/culture/country_value_dataset.json...
Processed prompts:   0%|          | 0/263 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]WARNING 03-06 14:26:27 scheduler.py:1560] Sequence group 347 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=151
Processed prompts:   0%|          | 1/263 [00:05<26:01,  5.96s/it, est. speed input: 68.95 toks/s, output: 8.89 toks/s]Processed prompts:   1%|          | 2/263 [00:07<14:13,  3.27s/it, est. speed input: 96.24 toks/s, output: 17.56 toks/s]Processed prompts:   1%|          | 3/263 [00:08<09:40,  2.23s/it, est. speed input: 110.83 toks/s, output: 26.60 toks/s]Processed prompts:   2%|▏         | 4/263 [00:10<08:50,  2.05s/it, est. speed input: 120.48 toks/s, output: 34.03 toks/s]Processed prompts:   2%|▏         | 5/263 [00:10<06:03,  1.41s/it, est. speed input: 128.57 toks/s, output: 45.33 toks/s]Processed prompts:   2%|▏         | 6/263 [00:12<07:04,  1.65s/it, est. speed input: 131.91 toks/s, output: 50.93 toks/s]Processed prompts:   3%|▎         | 7/263 [00:13<06:16,  1.47s/it, est. speed input: 138.14 toks/s, output: 60.54 toks/s]Processed prompts:   3%|▎         | 8/263 [00:14<05:18,  1.25s/it, est. speed input: 144.84 toks/s, output: 71.34 toks/s]Processed prompts:   3%|▎         | 9/263 [00:15<04:54,  1.16s/it, est. speed input: 149.50 toks/s, output: 81.23 toks/s]Processed prompts:   4%|▍         | 10/263 [00:17<06:37,  1.57s/it, est. speed input: 163.47 toks/s, output: 85.10 toks/s]Processed prompts:   4%|▍         | 11/263 [00:19<06:29,  1.54s/it, est. speed input: 165.35 toks/s, output: 93.62 toks/s]Processed prompts:   5%|▍         | 12/263 [00:19<04:57,  1.19s/it, est. speed input: 189.39 toks/s, output: 106.96 toks/s]Processed prompts:   5%|▌         | 14/263 [00:20<03:03,  1.36it/s, est. speed input: 236.58 toks/s, output: 134.11 toks/s]Processed prompts:   6%|▌         | 15/263 [00:20<02:36,  1.58it/s, est. speed input: 250.13 toks/s, output: 147.14 toks/s]Processed prompts:   6%|▌         | 16/263 [00:21<03:26,  1.20it/s, est. speed input: 240.54 toks/s, output: 153.17 toks/s]Processed prompts:   6%|▋         | 17/263 [00:24<04:54,  1.20s/it, est. speed input: 234.40 toks/s, output: 155.36 toks/s]Processed prompts:   7%|▋         | 18/263 [00:25<05:05,  1.25s/it, est. speed input: 236.01 toks/s, output: 163.16 toks/s]Processed prompts:   7%|▋         | 19/263 [00:28<06:50,  1.68s/it, est. speed input: 221.29 toks/s, output: 163.89 toks/s]Processed prompts:   8%|▊         | 20/263 [00:28<05:30,  1.36s/it, est. speed input: 227.04 toks/s, output: 177.42 toks/s]Processed prompts:   8%|▊         | 21/263 [00:28<04:11,  1.04s/it, est. speed input: 233.89 toks/s, output: 192.63 toks/s]Processed prompts:   8%|▊         | 22/263 [00:29<03:19,  1.21it/s, est. speed input: 240.29 toks/s, output: 207.30 toks/s]Processed prompts:   9%|▊         | 23/263 [00:30<03:24,  1.17it/s, est. speed input: 237.61 toks/s, output: 217.96 toks/s]Processed prompts:  21%|██▏       | 56/263 [00:32<00:27,  7.64it/s, est. speed input: 567.34 toks/s, output: 715.03 toks/s]Processed prompts:  22%|██▏       | 57/263 [00:35<00:47,  4.37it/s, est. speed input: 530.49 toks/s, output: 667.29 toks/s]Processed prompts:  22%|██▏       | 58/263 [00:35<00:46,  4.37it/s, est. speed input: 543.94 toks/s, output: 677.41 toks/s]Processed prompts:  22%|██▏       | 59/263 [00:36<00:54,  3.77it/s, est. speed input: 539.66 toks/s, output: 665.07 toks/s]Processed prompts:  23%|██▎       | 60/263 [00:36<00:51,  3.97it/s, est. speed input: 544.64 toks/s, output: 668.42 toks/s]Processed prompts:  23%|██▎       | 61/263 [00:36<00:49,  4.09it/s, est. speed input: 546.86 toks/s, output: 666.66 toks/s]WARNING 03-06 14:27:00 scheduler.py:1560] Sequence group 393 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=201
Processed prompts:  24%|██▎       | 62/263 [00:38<01:17,  2.58it/s, est. speed input: 533.21 toks/s, output: 650.78 toks/s]Processed prompts:  24%|██▍       | 63/263 [00:38<01:12,  2.78it/s, est. speed input: 538.23 toks/s, output: 660.34 toks/s]Processed prompts:  24%|██▍       | 64/263 [00:38<01:04,  3.06it/s, est. speed input: 543.85 toks/s, output: 662.27 toks/s]Processed prompts:  25%|██▍       | 65/263 [00:41<02:57,  1.11it/s, est. speed input: 508.88 toks/s, output: 625.59 toks/s]Processed prompts:  25%|██▌       | 66/263 [00:43<04:04,  1.24s/it, est. speed input: 489.67 toks/s, output: 603.69 toks/s]Processed prompts:  25%|██▌       | 67/263 [00:44<03:45,  1.15s/it, est. speed input: 486.69 toks/s, output: 597.88 toks/s]Processed prompts:  26%|██▌       | 68/263 [00:46<04:14,  1.30s/it, est. speed input: 478.72 toks/s, output: 580.69 toks/s]Processed prompts:  27%|██▋       | 70/263 [00:46<02:47,  1.15it/s, est. speed input: 482.93 toks/s, output: 584.39 toks/s]Processed prompts:  28%|██▊       | 73/263 [00:48<02:07,  1.49it/s, est. speed input: 494.75 toks/s, output: 590.48 toks/s]Processed prompts:  28%|██▊       | 74/263 [00:48<01:49,  1.73it/s, est. speed input: 500.20 toks/s, output: 594.02 toks/s]Processed prompts:  29%|██▊       | 75/263 [00:49<01:55,  1.63it/s, est. speed input: 497.45 toks/s, output: 593.24 toks/s]Processed prompts:  29%|██▉       | 76/263 [00:49<01:36,  1.94it/s, est. speed input: 503.08 toks/s, output: 596.83 toks/s]Processed prompts:  29%|██▉       | 77/263 [00:49<01:20,  2.32it/s, est. speed input: 507.52 toks/s, output: 601.13 toks/s]Processed prompts:  30%|██▉       | 78/263 [00:50<01:18,  2.35it/s, est. speed input: 514.74 toks/s, output: 606.41 toks/s]Processed prompts:  30%|███       | 79/263 [00:50<01:08,  2.68it/s, est. speed input: 517.64 toks/s, output: 609.63 toks/s]Processed prompts:  30%|███       | 80/263 [00:50<01:25,  2.15it/s, est. speed input: 515.30 toks/s, output: 611.28 toks/s]Processed prompts:  31%|███       | 81/263 [00:51<01:14,  2.45it/s, est. speed input: 518.71 toks/s, output: 614.32 toks/s]Processed prompts:  32%|███▏      | 83/263 [00:51<01:09,  2.57it/s, est. speed input: 526.71 toks/s, output: 621.75 toks/s]Processed prompts:  32%|███▏      | 84/263 [00:52<01:03,  2.83it/s, est. speed input: 528.89 toks/s, output: 625.25 toks/s]Processed prompts:  32%|███▏      | 85/263 [00:52<01:19,  2.25it/s, est. speed input: 526.77 toks/s, output: 626.56 toks/s]Processed prompts:  33%|███▎      | 86/263 [00:53<01:19,  2.22it/s, est. speed input: 526.86 toks/s, output: 625.36 toks/s]Processed prompts:  33%|███▎      | 87/263 [00:53<01:18,  2.25it/s, est. speed input: 525.67 toks/s, output: 629.85 toks/s]Processed prompts:  33%|███▎      | 88/263 [00:54<01:26,  2.02it/s, est. speed input: 524.96 toks/s, output: 632.06 toks/s]Processed prompts:  34%|███▍      | 89/263 [00:55<01:50,  1.57it/s, est. speed input: 524.14 toks/s, output: 627.60 toks/s]Processed prompts:  34%|███▍      | 90/263 [00:55<01:26,  2.00it/s, est. speed input: 526.28 toks/s, output: 634.91 toks/s]Processed prompts:  35%|███▍      | 91/263 [00:56<01:35,  1.79it/s, est. speed input: 527.56 toks/s, output: 636.17 toks/s]Processed prompts:  35%|███▍      | 92/263 [00:56<01:35,  1.80it/s, est. speed input: 526.49 toks/s, output: 637.38 toks/s]Processed prompts:  35%|███▌      | 93/263 [00:57<01:17,  2.20it/s, est. speed input: 531.66 toks/s, output: 642.44 toks/s]Processed prompts:  36%|███▌      | 94/263 [00:57<01:02,  2.70it/s, est. speed input: 540.72 toks/s, output: 649.44 toks/s]Processed prompts:  36%|███▌      | 95/263 [00:57<01:12,  2.33it/s, est. speed input: 539.19 toks/s, output: 651.96 toks/s]Processed prompts:  37%|███▋      | 96/263 [00:57<00:58,  2.84it/s, est. speed input: 541.86 toks/s, output: 658.20 toks/s]Processed prompts:  37%|███▋      | 97/263 [00:58<01:13,  2.25it/s, est. speed input: 545.00 toks/s, output: 659.51 toks/s]Processed prompts:  37%|███▋      | 98/263 [00:59<01:25,  1.94it/s, est. speed input: 541.05 toks/s, output: 660.53 toks/s]Processed prompts:  38%|███▊      | 99/263 [00:59<01:15,  2.19it/s, est. speed input: 542.35 toks/s, output: 665.58 toks/s]Processed prompts:  38%|███▊      | 100/263 [00:59<01:05,  2.49it/s, est. speed input: 544.93 toks/s, output: 671.09 toks/s]Processed prompts:  38%|███▊      | 101/263 [01:00<00:54,  2.99it/s, est. speed input: 545.93 toks/s, output: 677.64 toks/s]Processed prompts:  39%|███▉      | 102/263 [01:00<01:01,  2.63it/s, est. speed input: 546.31 toks/s, output: 680.66 toks/s]Processed prompts:  39%|███▉      | 103/263 [01:00<01:00,  2.64it/s, est. speed input: 547.17 toks/s, output: 684.84 toks/s]Processed prompts:  40%|███▉      | 104/263 [01:01<01:08,  2.33it/s, est. speed input: 546.29 toks/s, output: 683.85 toks/s]Processed prompts:  40%|███▉      | 105/263 [01:02<01:12,  2.17it/s, est. speed input: 552.61 toks/s, output: 686.19 toks/s]Processed prompts:  40%|████      | 106/263 [01:02<01:08,  2.28it/s, est. speed input: 553.82 toks/s, output: 690.15 toks/s]Processed prompts:  46%|████▌     | 121/263 [01:03<00:18,  7.52it/s, est. speed input: 610.58 toks/s, output: 796.83 toks/s]Processed prompts:  46%|████▋     | 122/263 [01:03<00:19,  7.24it/s, est. speed input: 614.06 toks/s, output: 798.99 toks/s]Processed prompts:  47%|████▋     | 123/263 [01:04<00:27,  5.17it/s, est. speed input: 611.62 toks/s, output: 796.25 toks/s]Processed prompts:  47%|████▋     | 124/263 [01:07<01:08,  2.04it/s, est. speed input: 595.32 toks/s, output: 772.95 toks/s]Processed prompts:  48%|████▊     | 125/263 [01:08<01:23,  1.66it/s, est. speed input: 586.97 toks/s, output: 766.32 toks/s]Processed prompts:  48%|████▊     | 127/263 [01:09<01:11,  1.91it/s, est. speed input: 595.20 toks/s, output: 762.26 toks/s]Processed prompts:  49%|████▊     | 128/263 [01:09<01:06,  2.03it/s, est. speed input: 594.93 toks/s, output: 765.83 toks/s]WARNING 03-06 14:27:32 scheduler.py:1560] Sequence group 460 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=251
Processed prompts:  49%|████▉     | 129/263 [01:10<01:10,  1.91it/s, est. speed input: 596.85 toks/s, output: 761.08 toks/s]Processed prompts:  49%|████▉     | 130/263 [01:12<01:59,  1.12it/s, est. speed input: 582.69 toks/s, output: 744.64 toks/s]Processed prompts:  50%|████▉     | 131/263 [01:12<01:40,  1.31it/s, est. speed input: 581.99 toks/s, output: 743.14 toks/s]Processed prompts:  50%|█████     | 132/263 [01:12<01:21,  1.61it/s, est. speed input: 581.49 toks/s, output: 747.97 toks/s]Processed prompts:  51%|█████     | 133/263 [01:13<01:08,  1.90it/s, est. speed input: 582.26 toks/s, output: 747.37 toks/s]Processed prompts:  51%|█████     | 134/263 [01:13<00:59,  2.17it/s, est. speed input: 588.87 toks/s, output: 748.50 toks/s]Processed prompts:  51%|█████▏    | 135/263 [01:13<01:02,  2.05it/s, est. speed input: 588.11 toks/s, output: 749.76 toks/s]Processed prompts:  52%|█████▏    | 136/263 [01:15<01:50,  1.15it/s, est. speed input: 576.17 toks/s, output: 738.52 toks/s]Processed prompts:  52%|█████▏    | 137/263 [01:16<01:34,  1.33it/s, est. speed input: 576.83 toks/s, output: 737.26 toks/s]Processed prompts:  52%|█████▏    | 138/263 [01:18<02:10,  1.04s/it, est. speed input: 566.75 toks/s, output: 725.15 toks/s]Processed prompts:  53%|█████▎    | 139/263 [01:18<01:46,  1.16it/s, est. speed input: 569.98 toks/s, output: 727.74 toks/s]Processed prompts:  53%|█████▎    | 140/263 [01:20<02:15,  1.10s/it, est. speed input: 560.78 toks/s, output: 716.11 toks/s]Processed prompts:  54%|█████▎    | 141/263 [01:20<01:53,  1.07it/s, est. speed input: 561.90 toks/s, output: 717.64 toks/s]Processed prompts:  54%|█████▍    | 142/263 [01:21<01:50,  1.10it/s, est. speed input: 559.29 toks/s, output: 716.32 toks/s]Processed prompts:  54%|█████▍    | 143/263 [01:21<01:31,  1.31it/s, est. speed input: 558.83 toks/s, output: 718.90 toks/s]Processed prompts:  55%|█████▍    | 144/263 [01:22<01:23,  1.43it/s, est. speed input: 556.81 toks/s, output: 719.15 toks/s]Processed prompts:  55%|█████▌    | 145/263 [01:22<01:04,  1.82it/s, est. speed input: 558.08 toks/s, output: 722.69 toks/s]Processed prompts:  56%|█████▌    | 146/263 [01:23<01:19,  1.47it/s, est. speed input: 553.16 toks/s, output: 718.65 toks/s]Processed prompts:  56%|█████▌    | 147/263 [01:23<01:04,  1.80it/s, est. speed input: 553.15 toks/s, output: 720.64 toks/s]Processed prompts:  56%|█████▋    | 148/263 [01:24<00:52,  2.18it/s, est. speed input: 553.29 toks/s, output: 723.42 toks/s]Processed prompts:  57%|█████▋    | 149/263 [01:24<01:01,  1.85it/s, est. speed input: 553.30 toks/s, output: 722.62 toks/s]Processed prompts:  57%|█████▋    | 150/263 [01:25<01:09,  1.64it/s, est. speed input: 550.76 toks/s, output: 722.05 toks/s]Processed prompts:  57%|█████▋    | 151/263 [01:25<00:57,  1.96it/s, est. speed input: 551.22 toks/s, output: 725.67 toks/s]Processed prompts:  58%|█████▊    | 152/263 [01:26<00:50,  2.22it/s, est. speed input: 552.32 toks/s, output: 728.16 toks/s]Processed prompts:  58%|█████▊    | 153/263 [01:26<00:49,  2.23it/s, est. speed input: 552.53 toks/s, output: 730.36 toks/s]Processed prompts:  59%|█████▊    | 154/263 [01:27<00:58,  1.87it/s, est. speed input: 550.40 toks/s, output: 730.03 toks/s]Processed prompts:  59%|█████▉    | 156/263 [01:27<00:40,  2.66it/s, est. speed input: 556.25 toks/s, output: 737.51 toks/s]Processed prompts:  60%|█████▉    | 157/263 [01:28<00:35,  2.97it/s, est. speed input: 557.06 toks/s, output: 740.55 toks/s]Processed prompts:  60%|██████    | 158/263 [01:28<00:41,  2.55it/s, est. speed input: 557.55 toks/s, output: 741.75 toks/s]Processed prompts:  60%|██████    | 159/263 [01:29<00:55,  1.86it/s, est. speed input: 554.93 toks/s, output: 739.81 toks/s]Processed prompts:  61%|██████    | 160/263 [01:30<00:55,  1.86it/s, est. speed input: 557.67 toks/s, output: 740.55 toks/s]Processed prompts:  62%|██████▏   | 163/263 [01:30<00:30,  3.24it/s, est. speed input: 562.30 toks/s, output: 754.54 toks/s]Processed prompts:  63%|██████▎   | 165/263 [01:30<00:23,  4.16it/s, est. speed input: 566.21 toks/s, output: 761.98 toks/s]Processed prompts:  63%|██████▎   | 166/263 [01:30<00:22,  4.41it/s, est. speed input: 567.90 toks/s, output: 766.18 toks/s]Processed prompts:  63%|██████▎   | 167/263 [01:31<00:33,  2.85it/s, est. speed input: 567.42 toks/s, output: 765.13 toks/s]Processed prompts:  64%|██████▍   | 168/263 [01:32<00:40,  2.37it/s, est. speed input: 565.21 toks/s, output: 765.32 toks/s]Processed prompts:  64%|██████▍   | 169/263 [01:32<00:39,  2.37it/s, est. speed input: 568.67 toks/s, output: 767.34 toks/s]Processed prompts:  65%|██████▍   | 170/263 [01:33<00:38,  2.44it/s, est. speed input: 569.36 toks/s, output: 769.72 toks/s]Processed prompts:  73%|███████▎  | 192/263 [01:34<00:08,  8.10it/s, est. speed input: 622.05 toks/s, output: 868.58 toks/s]Processed prompts:  73%|███████▎  | 193/263 [01:36<00:12,  5.76it/s, est. speed input: 618.79 toks/s, output: 864.53 toks/s]Processed prompts:  74%|███████▍  | 194/263 [01:37<00:18,  3.66it/s, est. speed input: 614.92 toks/s, output: 854.26 toks/s]Processed prompts:  74%|███████▍  | 195/263 [01:38<00:20,  3.26it/s, est. speed input: 612.44 toks/s, output: 852.13 toks/s]Processed prompts:  75%|███████▍  | 196/263 [01:39<00:27,  2.43it/s, est. speed input: 607.94 toks/s, output: 847.03 toks/s]Processed prompts:  75%|███████▍  | 197/263 [01:42<00:51,  1.27it/s, est. speed input: 592.68 toks/s, output: 824.78 toks/s]Processed prompts:  76%|███████▌  | 199/263 [01:42<00:38,  1.68it/s, est. speed input: 602.55 toks/s, output: 826.29 toks/s]Processed prompts:  76%|███████▌  | 200/263 [01:43<00:38,  1.63it/s, est. speed input: 599.93 toks/s, output: 823.68 toks/s]Processed prompts:  76%|███████▋  | 201/263 [01:44<00:46,  1.33it/s, est. speed input: 595.38 toks/s, output: 815.14 toks/s]Processed prompts:  77%|███████▋  | 202/263 [01:44<00:38,  1.60it/s, est. speed input: 597.08 toks/s, output: 815.53 toks/s]Processed prompts:  77%|███████▋  | 203/263 [01:45<00:30,  1.95it/s, est. speed input: 602.57 toks/s, output: 816.12 toks/s]Processed prompts:  78%|███████▊  | 205/263 [01:45<00:26,  2.19it/s, est. speed input: 602.25 toks/s, output: 816.22 toks/s]Processed prompts:  78%|███████▊  | 206/263 [01:47<00:40,  1.42it/s, est. speed input: 596.20 toks/s, output: 806.48 toks/s]Processed prompts:  79%|███████▊  | 207/263 [01:47<00:32,  1.72it/s, est. speed input: 601.15 toks/s, output: 807.05 toks/s]Processed prompts:  79%|███████▉  | 208/263 [01:48<00:32,  1.70it/s, est. speed input: 600.13 toks/s, output: 804.98 toks/s]Processed prompts:  80%|████████  | 211/263 [01:49<00:23,  2.22it/s, est. speed input: 602.95 toks/s, output: 805.89 toks/s]Processed prompts:  81%|████████  | 212/263 [01:50<00:36,  1.41it/s, est. speed input: 596.34 toks/s, output: 795.59 toks/s]Processed prompts:  81%|████████  | 213/263 [01:51<00:31,  1.60it/s, est. speed input: 596.97 toks/s, output: 797.83 toks/s]Processed prompts:  82%|████████▏ | 215/263 [01:53<00:39,  1.22it/s, est. speed input: 590.53 toks/s, output: 787.90 toks/s]Processed prompts:  82%|████████▏ | 216/263 [01:53<00:34,  1.34it/s, est. speed input: 590.60 toks/s, output: 787.64 toks/s]Processed prompts:  83%|████████▎ | 217/263 [01:54<00:34,  1.35it/s, est. speed input: 588.24 toks/s, output: 786.10 toks/s]WARNING 03-06 14:28:17 scheduler.py:1560] Sequence group 523 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=301
Processed prompts:  83%|████████▎ | 218/263 [01:55<00:29,  1.53it/s, est. speed input: 588.55 toks/s, output: 786.50 toks/s]Processed prompts:  83%|████████▎ | 219/263 [01:55<00:28,  1.54it/s, est. speed input: 587.30 toks/s, output: 786.36 toks/s]Processed prompts:  84%|████████▎ | 220/263 [01:56<00:29,  1.44it/s, est. speed input: 588.31 toks/s, output: 785.27 toks/s]Processed prompts:  84%|████████▍ | 221/263 [01:58<00:44,  1.06s/it, est. speed input: 581.30 toks/s, output: 775.70 toks/s]Processed prompts:  84%|████████▍ | 222/263 [01:59<00:40,  1.02it/s, est. speed input: 580.57 toks/s, output: 774.48 toks/s]Processed prompts:  85%|████████▍ | 223/263 [01:59<00:30,  1.33it/s, est. speed input: 582.69 toks/s, output: 777.28 toks/s]Processed prompts:  85%|████████▌ | 224/263 [01:59<00:23,  1.68it/s, est. speed input: 585.23 toks/s, output: 779.67 toks/s]Processed prompts:  86%|████████▌ | 225/263 [02:00<00:23,  1.60it/s, est. speed input: 584.19 toks/s, output: 779.34 toks/s]Processed prompts:  87%|████████▋ | 230/263 [02:00<00:07,  4.46it/s, est. speed input: 594.45 toks/s, output: 799.48 toks/s]Processed prompts:  89%|████████▉ | 234/263 [02:00<00:04,  6.77it/s, est. speed input: 604.77 toks/s, output: 815.15 toks/s]Processed prompts:  90%|████████▉ | 236/263 [02:01<00:05,  4.71it/s, est. speed input: 605.10 toks/s, output: 817.83 toks/s]Processed prompts:  90%|█████████ | 238/263 [02:02<00:05,  4.37it/s, est. speed input: 608.79 toks/s, output: 822.50 toks/s]Processed prompts:  98%|█████████▊| 259/263 [02:02<00:00, 14.11it/s, est. speed input: 657.18 toks/s, output: 905.97 toks/s]Processed prompts:  99%|█████████▉| 261/263 [02:03<00:00,  8.25it/s, est. speed input: 659.40 toks/s, output: 903.72 toks/s]Processed prompts: 100%|██████████| 263/263 [02:07<00:00,  3.21it/s, est. speed input: 645.75 toks/s, output: 887.91 toks/s]Processed prompts: 100%|██████████| 263/263 [02:07<00:00,  2.07it/s, est. speed input: 645.75 toks/s, output: 887.91 toks/s]
country_value_dataset          0.3270    86         263       
Processing sparta_alignment/data/culture/rule_of_thumb_dataset.json...
Processed prompts:   0%|          | 0/263 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:   0%|          | 1/263 [00:06<29:05,  6.66s/it, est. speed input: 47.13 toks/s, output: 9.76 toks/s]Processed prompts:   1%|          | 2/263 [00:09<18:34,  4.27s/it, est. speed input: 63.39 toks/s, output: 18.68 toks/s]Processed prompts:   1%|          | 3/263 [00:10<11:37,  2.68s/it, est. speed input: 94.32 toks/s, output: 29.35 toks/s]Processed prompts:   2%|▏         | 4/263 [00:10<08:19,  1.93s/it, est. speed input: 122.29 toks/s, output: 39.81 toks/s]Processed prompts:   2%|▏         | 5/263 [00:11<06:08,  1.43s/it, est. speed input: 131.58 toks/s, output: 50.75 toks/s]Processed prompts:   2%|▏         | 6/263 [00:12<06:05,  1.42s/it, est. speed input: 144.65 toks/s, output: 58.55 toks/s]Processed prompts:   3%|▎         | 7/263 [00:13<04:37,  1.08s/it, est. speed input: 167.25 toks/s, output: 70.26 toks/s]Processed prompts:   4%|▍         | 10/263 [00:13<02:12,  1.91it/s, est. speed input: 220.40 toks/s, output: 108.09 toks/s]Processed prompts:   4%|▍         | 11/263 [00:13<01:51,  2.25it/s, est. speed input: 237.16 toks/s, output: 120.37 toks/s]Processed prompts:   5%|▍         | 12/263 [00:14<02:39,  1.57it/s, est. speed input: 225.92 toks/s, output: 124.17 toks/s]Processed prompts:   5%|▍         | 13/263 [00:15<02:14,  1.86it/s, est. speed input: 246.45 toks/s, output: 136.12 toks/s]Processed prompts:   6%|▌         | 15/263 [00:15<01:47,  2.31it/s, est. speed input: 327.36 toks/s, output: 158.74 toks/s]Processed prompts:   6%|▌         | 16/263 [00:17<02:41,  1.53it/s, est. speed input: 312.62 toks/s, output: 160.33 toks/s]Processed prompts:   6%|▋         | 17/263 [00:17<02:17,  1.79it/s, est. speed input: 336.51 toks/s, output: 172.30 toks/s]Processed prompts:   7%|▋         | 18/263 [00:18<02:39,  1.53it/s, est. speed input: 331.17 toks/s, output: 178.33 toks/s]Processed prompts:   7%|▋         | 19/263 [00:19<03:04,  1.33it/s, est. speed input: 345.61 toks/s, output: 183.85 toks/s]Processed prompts:   8%|▊         | 20/263 [00:19<02:51,  1.42it/s, est. speed input: 353.39 toks/s, output: 193.58 toks/s]Processed prompts:   8%|▊         | 21/263 [00:20<02:30,  1.61it/s, est. speed input: 356.27 toks/s, output: 204.75 toks/s]Processed prompts:   8%|▊         | 22/263 [00:20<01:57,  2.04it/s, est. speed input: 371.93 toks/s, output: 218.13 toks/s]Processed prompts:   9%|▊         | 23/263 [00:21<02:18,  1.73it/s, est. speed input: 366.38 toks/s, output: 223.26 toks/s]Processed prompts:   9%|▉         | 24/263 [00:21<02:00,  1.98it/s, est. speed input: 373.18 toks/s, output: 234.43 toks/s]Processed prompts:  10%|▉         | 25/263 [00:22<02:16,  1.74it/s, est. speed input: 369.71 toks/s, output: 242.13 toks/s]Processed prompts:  10%|█         | 27/263 [00:22<01:31,  2.59it/s, est. speed input: 411.59 toks/s, output: 269.14 toks/s]Processed prompts:  11%|█         | 28/263 [00:24<02:26,  1.60it/s, est. speed input: 400.90 toks/s, output: 269.62 toks/s]Processed prompts:  11%|█         | 29/263 [00:24<02:01,  1.93it/s, est. speed input: 415.38 toks/s, output: 282.86 toks/s]Processed prompts:  11%|█▏        | 30/263 [00:25<02:19,  1.66it/s, est. speed input: 413.74 toks/s, output: 289.31 toks/s]Processed prompts:  12%|█▏        | 31/263 [00:25<02:15,  1.71it/s, est. speed input: 427.83 toks/s, output: 299.00 toks/s]Processed prompts:  12%|█▏        | 32/263 [00:26<02:48,  1.37it/s, est. speed input: 421.42 toks/s, output: 295.10 toks/s]WARNING 03-06 14:28:57 scheduler.py:1560] Sequence group 601 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=351
Processed prompts:  13%|█▎        | 34/263 [00:27<02:07,  1.79it/s, est. speed input: 432.81 toks/s, output: 319.18 toks/s]Processed prompts:  13%|█▎        | 35/263 [00:27<01:55,  1.97it/s, est. speed input: 435.29 toks/s, output: 322.32 toks/s]Processed prompts:  14%|█▎        | 36/263 [00:28<01:40,  2.26it/s, est. speed input: 448.39 toks/s, output: 335.44 toks/s]Processed prompts:  14%|█▍        | 37/263 [00:28<01:42,  2.20it/s, est. speed input: 447.08 toks/s, output: 345.83 toks/s]Processed prompts:  14%|█▍        | 38/263 [00:29<02:12,  1.70it/s, est. speed input: 442.58 toks/s, output: 350.98 toks/s]Processed prompts:  15%|█▍        | 39/263 [00:29<02:05,  1.79it/s, est. speed input: 443.37 toks/s, output: 361.59 toks/s]Processed prompts:  15%|█▌        | 40/263 [00:31<02:46,  1.34it/s, est. speed input: 430.77 toks/s, output: 364.02 toks/s]Processed prompts:  26%|██▌       | 69/263 [00:32<00:19,  9.85it/s, est. speed input: 710.76 toks/s, output: 791.69 toks/s]Processed prompts:  27%|██▋       | 70/263 [00:35<00:40,  4.81it/s, est. speed input: 664.75 toks/s, output: 748.81 toks/s]Processed prompts:  27%|██▋       | 71/263 [00:35<00:47,  4.05it/s, est. speed input: 653.11 toks/s, output: 743.60 toks/s]Processed prompts:  27%|██▋       | 72/263 [00:37<01:02,  3.06it/s, est. speed input: 637.47 toks/s, output: 720.82 toks/s]Processed prompts:  28%|██▊       | 73/263 [00:39<01:37,  1.94it/s, est. speed input: 609.38 toks/s, output: 682.81 toks/s]Processed prompts:  28%|██▊       | 74/263 [00:39<01:31,  2.06it/s, est. speed input: 611.26 toks/s, output: 680.54 toks/s]Processed prompts:  29%|██▊       | 75/263 [00:40<01:31,  2.04it/s, est. speed input: 609.77 toks/s, output: 675.52 toks/s]Processed prompts:  29%|██▉       | 76/263 [00:41<01:40,  1.86it/s, est. speed input: 604.37 toks/s, output: 674.50 toks/s]Processed prompts:  29%|██▉       | 77/263 [00:41<01:28,  2.10it/s, est. speed input: 608.06 toks/s, output: 673.74 toks/s]Processed prompts:  30%|██▉       | 78/263 [00:41<01:38,  1.88it/s, est. speed input: 604.91 toks/s, output: 665.47 toks/s]Processed prompts:  30%|███       | 79/263 [00:42<01:50,  1.67it/s, est. speed input: 602.61 toks/s, output: 656.55 toks/s]Processed prompts:  30%|███       | 80/263 [00:43<01:53,  1.61it/s, est. speed input: 597.21 toks/s, output: 650.02 toks/s]Processed prompts:  31%|███       | 81/263 [00:43<01:30,  2.01it/s, est. speed input: 599.19 toks/s, output: 651.60 toks/s]Processed prompts:  31%|███       | 82/263 [00:46<03:37,  1.20s/it, est. speed input: 570.42 toks/s, output: 614.20 toks/s]Processed prompts:  32%|███▏      | 83/263 [00:47<03:11,  1.06s/it, est. speed input: 566.81 toks/s, output: 615.64 toks/s]Processed prompts:  32%|███▏      | 84/263 [00:48<02:52,  1.04it/s, est. speed input: 565.03 toks/s, output: 617.08 toks/s]Processed prompts:  32%|███▏      | 85/263 [00:48<02:10,  1.37it/s, est. speed input: 570.15 toks/s, output: 620.24 toks/s]Processed prompts:  33%|███▎      | 86/263 [00:48<01:48,  1.63it/s, est. speed input: 574.71 toks/s, output: 621.35 toks/s]Processed prompts:  33%|███▎      | 87/263 [00:48<01:27,  2.01it/s, est. speed input: 577.19 toks/s, output: 623.98 toks/s]Processed prompts:  33%|███▎      | 88/263 [00:49<01:12,  2.41it/s, est. speed input: 583.86 toks/s, output: 626.65 toks/s]Processed prompts:  34%|███▍      | 89/263 [00:49<00:59,  2.92it/s, est. speed input: 585.85 toks/s, output: 629.88 toks/s]Processed prompts:  34%|███▍      | 90/263 [00:50<01:30,  1.91it/s, est. speed input: 583.86 toks/s, output: 628.15 toks/s]Processed prompts:  35%|███▍      | 91/263 [00:52<03:12,  1.12s/it, est. speed input: 561.17 toks/s, output: 604.62 toks/s]Processed prompts:  36%|███▌      | 94/263 [00:53<01:36,  1.76it/s, est. speed input: 575.91 toks/s, output: 622.23 toks/s]Processed prompts:  36%|███▌      | 95/263 [00:53<01:34,  1.77it/s, est. speed input: 575.99 toks/s, output: 622.55 toks/s]Processed prompts:  37%|███▋      | 96/263 [00:54<01:27,  1.90it/s, est. speed input: 575.94 toks/s, output: 627.40 toks/s]Processed prompts:  37%|███▋      | 97/263 [00:54<01:30,  1.84it/s, est. speed input: 575.10 toks/s, output: 627.44 toks/s]Processed prompts:  37%|███▋      | 98/263 [00:55<01:35,  1.73it/s, est. speed input: 573.51 toks/s, output: 628.97 toks/s]Processed prompts:  38%|███▊      | 99/263 [00:55<01:35,  1.72it/s, est. speed input: 577.22 toks/s, output: 631.49 toks/s]Processed prompts:  38%|███▊      | 100/263 [00:56<01:16,  2.13it/s, est. speed input: 581.58 toks/s, output: 636.54 toks/s]Processed prompts:  38%|███▊      | 101/263 [00:56<01:32,  1.75it/s, est. speed input: 577.75 toks/s, output: 634.95 toks/s]Processed prompts:  39%|███▉      | 102/263 [00:57<01:24,  1.91it/s, est. speed input: 577.40 toks/s, output: 635.23 toks/s]Processed prompts:  40%|███▉      | 104/263 [00:57<01:02,  2.55it/s, est. speed input: 581.65 toks/s, output: 644.82 toks/s]Processed prompts:  40%|███▉      | 105/263 [00:58<01:30,  1.74it/s, est. speed input: 575.20 toks/s, output: 640.02 toks/s]Processed prompts:  41%|████      | 107/263 [01:00<01:29,  1.74it/s, est. speed input: 571.48 toks/s, output: 644.79 toks/s]Processed prompts:  41%|████      | 108/263 [01:00<01:14,  2.07it/s, est. speed input: 572.69 toks/s, output: 651.54 toks/s]Processed prompts:  41%|████▏     | 109/263 [01:00<01:02,  2.46it/s, est. speed input: 575.11 toks/s, output: 657.63 toks/s]Processed prompts:  42%|████▏     | 110/263 [01:00<01:00,  2.55it/s, est. speed input: 576.52 toks/s, output: 662.21 toks/s]Processed prompts:  42%|████▏     | 111/263 [01:00<00:52,  2.90it/s, est. speed input: 577.81 toks/s, output: 668.29 toks/s]Processed prompts:  43%|████▎     | 112/263 [01:01<00:54,  2.77it/s, est. speed input: 578.84 toks/s, output: 672.21 toks/s]Processed prompts:  43%|████▎     | 113/263 [01:01<00:56,  2.67it/s, est. speed input: 583.61 toks/s, output: 676.08 toks/s]Processed prompts:  43%|████▎     | 114/263 [01:02<00:51,  2.88it/s, est. speed input: 585.53 toks/s, output: 681.17 toks/s]Processed prompts:  44%|████▎     | 115/263 [01:02<00:52,  2.83it/s, est. speed input: 593.19 toks/s, output: 685.33 toks/s]Processed prompts:  52%|█████▏    | 136/263 [01:04<00:15,  8.17it/s, est. speed input: 680.58 toks/s, output: 830.08 toks/s]Processed prompts:  52%|█████▏    | 137/263 [01:04<00:16,  7.81it/s, est. speed input: 683.66 toks/s, output: 827.42 toks/s]WARNING 03-06 14:29:35 scheduler.py:1560] Sequence group 749 is preempted by PreemptionMode.RECOMPUTE mode because there is not enough KV cache space. This can affect the end-to-end performance. Increase gpu_memory_utilization or tensor_parallel_size to provide more KV cache memory. total_num_cumulative_preemption=401
Processed prompts:  52%|█████▏    | 138/263 [01:08<00:53,  2.33it/s, est. speed input: 646.00 toks/s, output: 785.60 toks/s]Processed prompts:  53%|█████▎    | 140/263 [01:10<00:57,  2.15it/s, est. speed input: 641.89 toks/s, output: 779.87 toks/s]Processed prompts:  54%|█████▎    | 141/263 [01:11<01:07,  1.81it/s, est. speed input: 633.05 toks/s, output: 768.04 toks/s]Processed prompts:  54%|█████▍    | 142/263 [01:11<01:02,  1.93it/s, est. speed input: 634.02 toks/s, output: 771.97 toks/s]Processed prompts:  55%|█████▍    | 144/263 [01:12<00:53,  2.22it/s, est. speed input: 638.33 toks/s, output: 774.11 toks/s]Processed prompts:  55%|█████▌    | 145/263 [01:13<01:05,  1.79it/s, est. speed input: 634.90 toks/s, output: 764.47 toks/s]Processed prompts:  56%|█████▌    | 146/263 [01:15<01:46,  1.10it/s, est. speed input: 620.80 toks/s, output: 745.55 toks/s]Processed prompts:  56%|█████▌    | 147/263 [01:16<01:33,  1.24it/s, est. speed input: 621.76 toks/s, output: 743.89 toks/s]Processed prompts:  56%|█████▋    | 148/263 [01:16<01:18,  1.47it/s, est. speed input: 623.34 toks/s, output: 743.64 toks/s]Processed prompts:  57%|█████▋    | 149/263 [01:16<01:08,  1.66it/s, est. speed input: 623.95 toks/s, output: 742.70 toks/s]Processed prompts:  57%|█████▋    | 150/263 [01:17<00:59,  1.88it/s, est. speed input: 624.10 toks/s, output: 745.15 toks/s]Processed prompts:  57%|█████▋    | 151/263 [01:17<00:46,  2.42it/s, est. speed input: 626.03 toks/s, output: 746.83 toks/s]Processed prompts:  58%|█████▊    | 152/263 [01:17<00:46,  2.38it/s, est. speed input: 624.34 toks/s, output: 746.35 toks/s]Processed prompts:  58%|█████▊    | 153/263 [01:18<00:53,  2.04it/s, est. speed input: 623.44 toks/s, output: 744.92 toks/s]Processed prompts:  59%|█████▊    | 154/263 [01:18<00:51,  2.12it/s, est. speed input: 621.82 toks/s, output: 747.37 toks/s]Processed prompts:  59%|█████▉    | 156/263 [01:18<00:34,  3.08it/s, est. speed input: 630.29 toks/s, output: 752.25 toks/s]Processed prompts:  60%|██████    | 158/263 [01:20<00:44,  2.35it/s, est. speed input: 627.82 toks/s, output: 747.52 toks/s]Processed prompts:  60%|██████    | 159/263 [01:20<00:45,  2.29it/s, est. speed input: 626.25 toks/s, output: 746.37 toks/s]Processed prompts:  61%|██████    | 160/263 [01:21<00:55,  1.84it/s, est. speed input: 622.02 toks/s, output: 741.79 toks/s]Processed prompts:  61%|██████    | 161/263 [01:21<00:49,  2.06it/s, est. speed input: 623.63 toks/s, output: 742.39 toks/s]Processed prompts:  62%|██████▏   | 162/263 [01:22<00:47,  2.13it/s, est. speed input: 622.18 toks/s, output: 742.17 toks/s]Processed prompts:  62%|██████▏   | 163/263 [01:22<00:41,  2.42it/s, est. speed input: 622.98 toks/s, output: 745.95 toks/s]Processed prompts:  63%|██████▎   | 165/263 [01:22<00:33,  2.90it/s, est. speed input: 622.98 toks/s, output: 748.71 toks/s]Processed prompts:  63%|██████▎   | 166/263 [01:23<00:29,  3.31it/s, est. speed input: 626.08 toks/s, output: 750.92 toks/s]Processed prompts:  63%|██████▎   | 167/263 [01:23<00:34,  2.79it/s, est. speed input: 629.42 toks/s, output: 750.03 toks/s]Processed prompts:  64%|██████▍   | 168/263 [01:24<00:36,  2.57it/s, est. speed input: 629.37 toks/s, output: 749.71 toks/s]Processed prompts:  64%|██████▍   | 169/263 [01:24<00:38,  2.44it/s, est. speed input: 633.65 toks/s, output: 751.61 toks/s]Processed prompts:  65%|██████▌   | 171/263 [01:24<00:28,  3.19it/s, est. speed input: 636.51 toks/s, output: 754.64 toks/s]Processed prompts:  65%|██████▌   | 172/263 [01:25<00:23,  3.82it/s, est. speed input: 638.90 toks/s, output: 757.75 toks/s]Processed prompts:  66%|██████▌   | 173/263 [01:25<00:29,  3.00it/s, est. speed input: 641.98 toks/s, output: 754.20 toks/s]Processed prompts:  66%|██████▌   | 174/263 [01:26<00:34,  2.60it/s, est. speed input: 643.52 toks/s, output: 753.60 toks/s]Processed prompts:  67%|██████▋   | 175/263 [01:26<00:33,  2.63it/s, est. speed input: 642.48 toks/s, output: 754.59 toks/s]Processed prompts:  67%|██████▋   | 176/263 [01:27<00:49,  1.76it/s, est. speed input: 636.32 toks/s, output: 750.16 toks/s]Processed prompts:  67%|██████▋   | 177/263 [01:28<01:04,  1.33it/s, est. speed input: 630.83 toks/s, output: 745.68 toks/s]Processed prompts:  68%|██████▊   | 178/263 [01:29<01:15,  1.13it/s, est. speed input: 624.91 toks/s, output: 741.39 toks/s]Processed prompts:  68%|██████▊   | 179/263 [01:30<01:05,  1.29it/s, est. speed input: 624.31 toks/s, output: 739.04 toks/s]Processed prompts:  68%|██████▊   | 180/263 [01:30<00:48,  1.70it/s, est. speed input: 625.34 toks/s, output: 743.52 toks/s]Processed prompts:  69%|██████▉   | 181/263 [01:31<00:50,  1.61it/s, est. speed input: 622.90 toks/s, output: 743.43 toks/s]Processed prompts:  69%|██████▉   | 182/263 [01:31<00:44,  1.84it/s, est. speed input: 624.94 toks/s, output: 745.86 toks/s]Processed prompts:  70%|██████▉   | 183/263 [01:32<00:40,  1.99it/s, est. speed input: 624.97 toks/s, output: 748.12 toks/s]Processed prompts:  70%|██████▉   | 184/263 [01:32<00:34,  2.32it/s, est. speed input: 626.60 toks/s, output: 751.55 toks/s]Processed prompts:  70%|███████   | 185/263 [01:32<00:27,  2.84it/s, est. speed input: 630.24 toks/s, output: 755.34 toks/s]Processed prompts:  71%|███████   | 186/263 [01:32<00:24,  3.15it/s, est. speed input: 630.86 toks/s, output: 758.92 toks/s]Processed prompts:  71%|███████   | 187/263 [01:33<00:25,  2.99it/s, est. speed input: 630.84 toks/s, output: 761.15 toks/s]Processed prompts:  71%|███████▏  | 188/263 [01:33<00:31,  2.39it/s, est. speed input: 629.35 toks/s, output: 761.44 toks/s]Processed prompts:  72%|███████▏  | 189/263 [01:34<00:29,  2.49it/s, est. speed input: 632.81 toks/s, output: 763.93 toks/s]Processed prompts:  73%|███████▎  | 191/263 [01:34<00:20,  3.58it/s, est. speed input: 636.92 toks/s, output: 772.50 toks/s]Processed prompts:  73%|███████▎  | 192/263 [01:34<00:23,  3.04it/s, est. speed input: 638.17 toks/s, output: 773.98 toks/s]Processed prompts:  80%|███████▉  | 210/263 [01:36<00:07,  6.87it/s, est. speed input: 676.48 toks/s, output: 851.51 toks/s]Processed prompts:  80%|████████  | 211/263 [01:37<00:07,  6.73it/s, est. speed input: 677.14 toks/s, output: 855.08 toks/s]Processed prompts:  81%|████████  | 212/263 [01:38<00:10,  4.80it/s, est. speed input: 674.25 toks/s, output: 852.80 toks/s]Processed prompts:  81%|████████▏ | 214/263 [01:38<00:10,  4.89it/s, est. speed input: 678.23 toks/s, output: 854.97 toks/s]Processed prompts:  82%|████████▏ | 215/263 [01:39<00:13,  3.48it/s, est. speed input: 673.39 toks/s, output: 852.52 toks/s]Processed prompts:  82%|████████▏ | 216/263 [01:39<00:15,  3.00it/s, est. speed input: 670.99 toks/s, output: 852.55 toks/s]Processed prompts:  83%|████████▎ | 217/263 [01:41<00:24,  1.91it/s, est. speed input: 664.39 toks/s, output: 841.93 toks/s]Processed prompts:  83%|████████▎ | 218/263 [01:43<00:42,  1.06it/s, est. speed input: 650.82 toks/s, output: 822.43 toks/s]Processed prompts:  84%|████████▎ | 220/263 [01:44<00:33,  1.29it/s, est. speed input: 652.22 toks/s, output: 821.85 toks/s]Processed prompts:  84%|████████▍ | 222/263 [01:45<00:22,  1.85it/s, est. speed input: 654.94 toks/s, output: 827.08 toks/s]Processed prompts:  85%|████████▍ | 223/263 [01:45<00:19,  2.10it/s, est. speed input: 657.59 toks/s, output: 827.35 toks/s]Processed prompts:  85%|████████▌ | 224/263 [01:46<00:28,  1.38it/s, est. speed input: 650.49 toks/s, output: 817.60 toks/s]Processed prompts:  86%|████████▌ | 226/263 [01:47<00:19,  1.93it/s, est. speed input: 654.95 toks/s, output: 821.83 toks/s]Processed prompts:  86%|████████▋ | 227/263 [01:47<00:16,  2.17it/s, est. speed input: 656.24 toks/s, output: 824.66 toks/s]Processed prompts:  87%|████████▋ | 228/263 [01:47<00:14,  2.48it/s, est. speed input: 657.64 toks/s, output: 825.54 toks/s]Processed prompts:  87%|████████▋ | 229/263 [01:47<00:11,  2.92it/s, est. speed input: 662.91 toks/s, output: 826.79 toks/s]Processed prompts:  88%|████████▊ | 231/263 [01:49<00:14,  2.18it/s, est. speed input: 664.27 toks/s, output: 824.59 toks/s]Processed prompts:  88%|████████▊ | 232/263 [01:49<00:11,  2.63it/s, est. speed input: 665.84 toks/s, output: 828.40 toks/s]Processed prompts:  89%|████████▊ | 233/263 [01:49<00:13,  2.28it/s, est. speed input: 664.95 toks/s, output: 828.40 toks/s]Processed prompts:  89%|████████▉ | 234/263 [01:50<00:15,  1.92it/s, est. speed input: 664.36 toks/s, output: 827.37 toks/s]Processed prompts:  89%|████████▉ | 235/263 [01:50<00:11,  2.44it/s, est. speed input: 666.35 toks/s, output: 829.73 toks/s]Processed prompts:  90%|████████▉ | 236/263 [01:51<00:10,  2.64it/s, est. speed input: 670.30 toks/s, output: 830.69 toks/s]Processed prompts:  90%|█████████ | 237/263 [01:51<00:07,  3.32it/s, est. speed input: 671.14 toks/s, output: 833.07 toks/s]Processed prompts:  90%|█████████ | 238/263 [01:51<00:10,  2.32it/s, est. speed input: 669.78 toks/s, output: 832.06 toks/s]Processed prompts:  91%|█████████ | 239/263 [01:52<00:11,  2.13it/s, est. speed input: 669.84 toks/s, output: 831.39 toks/s]Processed prompts:  91%|█████████▏| 240/263 [01:53<00:11,  2.03it/s, est. speed input: 669.08 toks/s, output: 831.89 toks/s]Processed prompts:  92%|█████████▏| 242/263 [01:54<00:14,  1.45it/s, est. speed input: 670.03 toks/s, output: 826.58 toks/s]Processed prompts:  92%|█████████▏| 243/263 [01:55<00:11,  1.74it/s, est. speed input: 671.51 toks/s, output: 829.36 toks/s]Processed prompts:  93%|█████████▎| 244/263 [01:55<00:08,  2.18it/s, est. speed input: 671.95 toks/s, output: 832.88 toks/s]Processed prompts:  95%|█████████▍| 249/263 [01:55<00:02,  5.54it/s, est. speed input: 681.11 toks/s, output: 853.98 toks/s]Processed prompts:  95%|█████████▌| 251/263 [01:55<00:01,  6.34it/s, est. speed input: 685.57 toks/s, output: 861.41 toks/s]Processed prompts:  96%|█████████▌| 253/263 [01:55<00:01,  5.74it/s, est. speed input: 686.84 toks/s, output: 867.02 toks/s]Processed prompts:  97%|█████████▋| 256/263 [01:56<00:00,  7.15it/s, est. speed input: 694.36 toks/s, output: 878.39 toks/s]Processed prompts: 100%|██████████| 263/263 [01:56<00:00,  2.26it/s, est. speed input: 714.82 toks/s, output: 909.22 toks/s]
rule_of_thumb_dataset          0.4601    121        263       
--------------------------------------------------------------------------------
Overall                        0.3790    299        789       
================================================================================

All results saved to sparta_alignment/data/culture/evaluation_results/oasst1/evaluation_results_test.json
[rank0]:[W306 14:30:27.639366429 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
